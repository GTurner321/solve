<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Equation Solver</title>
    <style>
        body {
            background-color: lightgreen;
            font-family: Arial, sans-serif;
        }
        .equation {
            font-size: 1.5em;
            margin-bottom: 10px;
        }
        .input-container {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .input-container input {
            margin-left: 5em;
        }
        .message {
            color: orange;
            margin-bottom: 10px;
        }
        .success {
            color: green;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div id="equations"></div>
    <script>
        function formatEquation(a, b, c, d) {
            // Format rules based on conditions
            if (a !== 0 && b === 0 && c === 0 && d !== 0) return `${a === 1 ? "x" : a === -1 ? "-x" : `${a}x`} = ${d.toFixed(3)}`;
            if (a === 0 && b !== 0 && c !== 0 && d === 0) return `${b.toFixed(3)} = ${c === 1 ? "x" : c === -1 ? "-x" : `${c}x`}`;
            if (a !== 0 && b === 0 && c !== 0 && d === 0) return `${a === 1 ? "x" : a === -1 ? "-x" : `${a}x`} = ${c === 1 ? "x" : c === -1 ? "-x" : `${c}x`}`;
            if (a !== 0 && b !== 0 && c === 0 && d === 0) return `${a === 1 ? "x" : a === -1 ? "-x" : `${a}x`} + ${b.toFixed(3)} = 0`;
            if (a === 0 && b !== 0 && c !== 0 && d === 0) return `${b.toFixed(3)} = ${c === 1 ? "x" : c === -1 ? "-x" : `${c}x`}`;
            if (a !== 0 && b === 0 && c !== 0 && d === 0) return `${a === 1 ? "x" : a === -1 ? "-x" : `${a}x`} = ${c === 1 ? "x" : c === -1 ? "-x" : `${c}x`}`;
            return `${a === 1 ? "x" : a === -1 ? "-x" : `${a}x`} + ${b.toFixed(3)} = ${c === 1 ? "x" : c === -1 ? "-x" : `${c}x`} + ${d.toFixed(3)}`;
        }

        function updateCursorFocus(inputElement) {
            setTimeout(() => {
                inputElement.focus();
            }, 0);
        }

        let equationContainer = document.getElementById("equations");
        let a = Math.floor(Math.random() * 10) + 1;
        let b = Math.floor(Math.random() * 10) + 1;
        let c = Math.floor(Math.random() * 10) + 1;
        let d = Math.floor(Math.random() * 10) + 1;
        while (a === c) {
            c = Math.floor(Math.random() * 10) + 1;
        }

        function createEquationLine() {
            let equationText = formatEquation(a, b, c, d);
            let newEquation = document.createElement("div");
            newEquation.className = "equation";
            newEquation.textContent = equationText;
            equationContainer.appendChild(newEquation);

            let inputContainer = document.createElement("div");
            inputContainer.className = "input-container";

            let inputBox = document.createElement("input");
            inputBox.type = "text";
            inputBox.placeholder = "Enter your operation";
            inputBox.addEventListener("keydown", (event) => {
                if (event.key === "Enter") {
                    let input = inputBox.value.trim();
                    if (/^[+-xX*]?\d+\.?\d*x?$/.test(input)) {
                        inputBox.disabled = true;

                        if (input === "x") {
                            input = "*1"; // Interpret as multiplication by 1
                        } else if (input === "-x") {
                            input = "-1x";
                        } else if (input === "+x") {
                            input = "+1x";
                        }

                        let operation = input[0];
                        let value = parseFloat(input.slice(1));

                        if (operation === "+") {
                            b += value;
                            d += value;
                        } else if (operation === "-") {
                            b -= value;
                            d -= value;
                        } else if (operation === "*" || operation.toLowerCase() === "x") {
                            a *= value;
                            b *= value;
                            c *= value;
                            d *= value;
                        } else if (operation === "/") {
                            a /= value;
                            b /= value;
                            c /= value;
                            d /= value;
                        } else {
                            return;
                        }

                        createEquationLine();
                        updateCursorFocus(document.querySelector("input:not([disabled])"));
                    } else {
                        let message = document.createElement("div");
                        message.className = "message";
                        message.textContent = "Try again";
                        equationContainer.appendChild(message);
                        updateCursorFocus(inputBox);
                    }
                }
            });

            inputContainer.appendChild(inputBox);
            equationContainer.appendChild(inputContainer);

            updateCursorFocus(inputBox);
        }

        createEquationLine();
    </script>
</body>
</html>
