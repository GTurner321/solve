<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Equation Solver</title>
    <style>
        body {
            background-color: lightgreen;
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        .equation {
            font-size: 2em;
            color: black;
            margin: 10px 0;
            text-align: center;
        }

        .input-container {
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: center;
        }

        .input-container input {
            font-size: 1em;
            padding: 5px;
        }

        .congrats {
            color: green;
            font-size: 1.5em;
            text-align: center;
            margin-top: 20px;
        }

        .error {
            color: red;
            font-size: 0.9em;
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="equations"></div>
        <div id="input-container"></div>
        <div id="congrats-message"></div>
    </div>

    <script>
        function randomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function generateEquation() {
            let a, c;
            do {
                a = randomInt(-10, 10);
                c = randomInt(-10, 10);
            } while (a === c || a === 0 || c === 0);
            const b = randomInt(-10, 10);
            const d = randomInt(-10, 10);
            return { a, b, c, d };
        }

        function formatEquation(a, b, c, d) {
            const formatTerm = (coef, variable = '') => {
                if (coef === 0) return '';
                if (coef === 1) return variable;
                if (coef === -1) return `-${variable}`;
                return `${coef}${variable}`;
            };

            const left = `${formatTerm(a, 'x')}${b !== 0 ? (b > 0 ? `+${b}` : b) : ''}`;
            const right = `${formatTerm(c, 'x')}${d !== 0 ? (d > 0 ? `+${d}` : d) : ''}`;

            return `${left || '0'}=${right || '0'}`;
        }

        function validateInput(input) {
            const regex = /^([+-/*xX]\d+|[+-]\d*x|[+-]x|[+\-]\d+)$/;
            return regex.test(input.trim());
        }

        function applyCommand(equation, command) {
            const { a, b, c, d } = equation;
            const cmd = command.trim().toLowerCase();
            let n;

            if (cmd.startsWith('+x') || cmd === '+x') n = 1;
            else if (cmd.startsWith('-x') || cmd === '-x') n = -1;
            else if (cmd.startsWith('+')) n = parseFloat(cmd.slice(1));
            else if (cmd.startsWith('-')) n = parseFloat(cmd.slice(1));
            else if (cmd.startsWith('*') || cmd.startsWith('x')) n = parseFloat(cmd.slice(1));
            else if (cmd.startsWith('/') || cmd.startsWith('รท')) n = parseFloat(cmd.slice(1));

            if (cmd.startsWith('+x') || cmd === '+x' || cmd.startsWith('-x') || cmd === '-x') {
                return { a, b: b + n, c, d: d + n };
            } else if (cmd.startsWith('+') || cmd.startsWith('-')) {
                return { a, b: b + n, c, d: d + n };
            } else if (cmd.startsWith('*') || cmd.startsWith('x')) {
                return { a: a * n, b: b * n, c: c * n, d: d * n };
            } else if (cmd.startsWith('/') || cmd.startsWith('รท')) {
                return { a: a / n, b: b / n, c: c / n, d: d / n };
            }

            return equation;
        }

        function isSolved(equation) {
            const { a, b, c, d } = equation;
            return (a === 1 && b === 0 && c === 0) || (a === 0 && c === 1 && d === 0);
        }

        function renderEquation(equation, container) {
            const eqDiv = document.createElement('div');
            eqDiv.className = 'equation';
            eqDiv.textContent = formatEquation(equation.a, equation.b, equation.c, equation.d);
            container.appendChild(eqDiv);
        }

        function renderInput(container, onSubmit) {
            const inputDiv = document.createElement('div');
            inputDiv.className = 'input-container';

            const input = document.createElement('input');
            input.type = 'text';
            input.placeholder = 'Enter command';

            const errorMsg = document.createElement('div');
            errorMsg.className = 'error';
            errorMsg.textContent = '';

            input.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    const command = input.value.trim();
                    if (validateInput(command)) {
                        errorMsg.textContent = '';
                        input.disabled = true;
                        onSubmit(command);
                    } else {
                        errorMsg.textContent = 'Try again';
                    }
                }
            });

            inputDiv.appendChild(input);
            inputDiv.appendChild(errorMsg);
            container.appendChild(inputDiv);
        }

        function main() {
            const container = document.getElementById('container');
            const equationsDiv = document.getElementById('equations');
            const inputContainer = document.getElementById('input-container');
            const congratsMessage = document.getElementById('congrats-message');

            let equation = generateEquation();
            renderEquation(equation, equationsDiv);

            function handleCommand(command) {
                equation = applyCommand(equation, command);
                renderEquation(equation, equationsDiv);

                if (isSolved(equation)) {
                    const xValue = equation.a === 1 ? equation.d : equation.b;
                    congratsMessage.textContent = `Well done! You have solved the equation. x=${xValue}`;
                } else {
                    renderInput(inputContainer, handleCommand);
                }
            }

            renderInput(inputContainer, handleCommand);
        }

        main();
    </script>
</body>
</html>
